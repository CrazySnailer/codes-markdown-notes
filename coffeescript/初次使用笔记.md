#CofeeScript初次使用笔记

```
http://jashkenas.github.io/coffee-script/#overview

1. ruby syntax
2. The golden rule of CoffeeScript is: "It's just JavaScript".
```

###不需要使用var关键字,局部var关键字带来的全局性差异被取消:

```
number   = 42
opposite = true
```

###ruby风格的条件语句

```
number = -42 if opposite

// 被翻译成
var number;
if (opposite) {
  number = -42;
}

alert "I knew it!" if elvis?

// 被翻译成
// 这个elvis饭后不会有var elvis;
if (typeof elvis !== "undefined" && elvis !== null) {
  alert("I knew it!");
}
```

###使用block来定义函数

```
square = (x) -> x * x

// 被翻译成
var square;
square = function(x) {
  r  eturn x * x;
};

//函数可以定义默认值，会被翻译成if语句
fill = (container, liquid = "coffee") ->
  "Filling the #{container} with #{liquid}..."

// 被翻译成 
var fill;
fill = function(container, liquid) {
  if (liquid == null) {
    liquid = "coffee";
  }
  return "Filling the " + container + " with " + liquid + "...";
};

//没有参数的简写
function_name = ->
  number = 1
//number = 1会被翻译成return number = 1作为返回值
```

###简单数组初始化和原生js差不多

```
list = [1, 2, 3, 4, 5]

// 被翻译成
list = [1, 2, 3, 4, 5];
```

###定义对象很简洁

```
math =
  root:   Math.sqrt
  square: square
  cube:   (x) -> x * square x
  
// 被翻译成
math = {
  root: Math.sqrt,
  square: square,
  cube: function(x) {
    return x * square(x);
  }
};
```

###if-else-conditions

```
mood = greatlyImproved if singing

//被翻译成
if (singing) {
  mood = greatlyImproved;
}

if happy and knowsIt
  clapsHands()
  chaChaCha()
else
  showIt()

//被翻译成
if (happy && knowsIt) {
  clapsHands();
  chaChaCha();
} else {
  showIt();
}
  
date = if friday then sue else jill

//被翻译成
date = friday ? sue : jill;
```

###迭代调用函数

```
eat food for food in ['toast', 'cheese', 'wine']

//比翻译成
_ref = ['toast', 'cheese', 'wine'];
for (_i = 0, _len = _ref.length; _i < _len; _i++) {
  food = _ref[_i];
  eat(food);
}

//带索引的迭代
courses = ['greens', 'caviar', 'truffles', 'roast', 'cake']
menu i + 1, dish for dish, i in courses

//被翻译成
for (i = _j = 0, _len1 = courses.length; _j < _len1; i = ++_j) {
  dish = courses[i];
  menu(i + 1, dish);
}

//迭代中使用条件,注意isnt关键字,相当于!==
foods = ['broccoli', 'spinach', 'chocolate']
eat food for food in foods when food isnt 'chocolate'

//被翻译成
for (_k = 0, _len2 = foods.length; _k < _len2; _k++) {
  food = foods[_k];
  if (food !== 'chocolate') {
    eat(food);
  }
}

//迭代对象
yearsOld = max: 10, ida: 9, tim: 11
ages = for child, age of yearsOld
  "#{child} is #{age}"
  
//被翻译成
var age, ages, child, yearsOld;

yearsOld = {
  max: 10,
  ida: 9,
  tim: 11
};

ages = (function() {
  var _results;

  _results = [];
  for (child in yearsOld) {
    age = yearsOld[child];
    _results.push("" + child + " is " + age);
  }
  return _results;
})();
```

###存在性

```
solipsism = true if mind? and not world?

//被翻译成
if ((typeof mind !== "undefined" && mind !== null) && (typeof world === "undefined" || world === null)) {
  solipsism = true;
}

speed = 0
speed ?= 15

//被翻译成
if (speed == null) {
  speed = 15;
}

footprints = yeti ? "bear"

//被翻译成
footprints = typeof yeti !== "undefined" && yeti !== null ? yeti : "bear";
```

###和jQuery搭配使用

```
//迭代jQuery对象
formValues = (elem.value for elem in $('.input'))

//使用"=>"将会大大减省你手动绑定方法到对象的麻烦
object =  
  func: -> $('#div').click => @element.css color: 'red'
  
//使用"=>"所指定的回调函数都会自动绑定到原来的对象上
$.post(  
  "/posts/update_title" 
  new_title: input.val()  
  id: something  
  -> alert('done')  
  'json' 
) 

//可选的逗号和括号
$('#thing').animate  
  width: '+20px' 
  opacity: '0.5' 
  2000  
  'easeOutQuad'
  
//初始化
$->  
  some()  
  init()  
  calls() 
//对应着
$(document).ready(function() {  
  some();  
  init();  
  calls();  
});
```

###点滴

```
foo = { bar: "bar" }
if foo?.bar then console.log foo.bar
//被翻译成
if (foo != null && foo.bar) { ... }

//绑定字符串
pokemon = "Snorlax"
console.log "Wild #{pokemon.toUpperCase()} appeared!"

//长字符串
blurb = "I don't always drink beer,
         but when I do,
         I prefer Dos Equis."
console.log blurb
//"I don't always drink beer, but when I do, I prefer Dos Equis."

//文档标记格式,不用担心转义
html = """
       <div class="article">
         <h1>Honey Badger</h1>
         <p>Honey Badger don't care.</p>
       </div>
       """

//map和filter操作
( expression for item in array )
( expression for item in array when condition )

( expression for key, value of object )
( expression for key, value of object when condition )

//OOP
class Shape
  constructor: (@x, @y) ->
  centre: -> [ @x, @y ]
  area: -> 0
point = new Shape 13, 37

//继承,@x翻译成this.x
class Shape
  constructor: (@x, @y) ->
  centre: -> [ @x, @y ]
  area: -> 0

class Circle extends Shape
  constructor: (x, y, @radius) ->
    super x, y
circle = new Circle 13, 37, 5
```